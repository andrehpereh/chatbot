{
  "components": {
    "comp-convert-checkpoints-op": {
      "executorLabel": "exec-convert-checkpoints-op",
      "inputDefinitions": {
        "parameters": {
          "bucket_name": {
            "parameterType": "STRING"
          },
          "keras_gcs_model": {
            "parameterType": "STRING"
          },
          "model_paths": {
            "parameterType": "STRUCT"
          }
        }
      },
      "outputDefinitions": {
        "parameters": {
          "Output": {
            "parameterType": "STRING"
          }
        }
      }
    },
    "comp-data-preparation-op": {
      "executorLabel": "exec-data-preparation-op",
      "inputDefinitions": {
        "parameters": {
          "bucket_name": {
            "parameterType": "STRING"
          },
          "data_augmentation_iter": {
            "defaultValue": 4.0,
            "isOptional": true,
            "parameterType": "NUMBER_INTEGER"
          },
          "directory": {
            "parameterType": "STRING"
          },
          "pair_count": {
            "defaultValue": 4.0,
            "isOptional": true,
            "parameterType": "NUMBER_INTEGER"
          }
        }
      },
      "outputDefinitions": {
        "artifacts": {
          "dataset_path": {
            "artifactType": {
              "schemaTitle": "system.Dataset",
              "schemaVersion": "0.0.1"
            }
          }
        }
      }
    },
    "comp-endpoint-create": {
      "executorLabel": "exec-endpoint-create",
      "inputDefinitions": {
        "parameters": {
          "description": {
            "defaultValue": "",
            "description": "The description of the Endpoint.",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "display_name": {
            "description": "The user-defined name of the Endpoint. The name can be up to 128 characters long and can be consist of any UTF-8 characters.",
            "parameterType": "STRING"
          },
          "encryption_spec_key_name": {
            "defaultValue": "",
            "description": "Customer-managed encryption key spec for an Endpoint. If set, this Endpoint and all of this Endoint's sub-resources will be secured by this key. Has the form: `projects/my-project/locations/my-location/keyRings/my-kr/cryptoKeys/my-key`. The key needs to be in the same region as where the compute resource is created.  If set, this Endpoint and all sub-resources of this Endpoint will be secured by this key.",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "labels": {
            "defaultValue": {},
            "description": "The labels with user-defined metadata to organize your Endpoints.  Label keys and values can be no longer than 64 characters (Unicode codepoints), can only contain lowercase letters, numeric characters, underscores and dashes. International characters are allowed.  See https://goo.gl/xmQnxf for more information and examples of labels.",
            "isOptional": true,
            "parameterType": "STRUCT"
          },
          "location": {
            "defaultValue": "us-central1",
            "description": "Location to create the Endpoint. If not set, default to us-central1.",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "network": {
            "defaultValue": "",
            "description": "The full name of the Google Compute Engine network to which the Endpoint should be peered. Private services access must already be configured for the network. If left unspecified, the Endpoint is not peered with any network. [Format](https://cloud.google.com/compute/docs/reference/rest/v1/networks/insert): `projects/{project}/global/networks/{network}`. Where `{project}` is a project number, as in `'12345'`, and `{network}` is network name.",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "project": {
            "defaultValue": "{{$.pipeline_google_cloud_project_id}}",
            "description": "Project to create the Endpoint. Defaults to the project in which the PipelineJob is run.",
            "isOptional": true,
            "parameterType": "STRING"
          }
        }
      },
      "outputDefinitions": {
        "artifacts": {
          "endpoint": {
            "artifactType": {
              "schemaTitle": "google.VertexEndpoint",
              "schemaVersion": "0.0.1"
            },
            "description": "Artifact tracking the created Endpoint."
          }
        },
        "parameters": {
          "gcp_resources": {
            "description": "Serialized JSON of `gcp_resources` [proto](https://github.com/kubeflow/pipelines/tree/master/components/google-cloud/google_cloud_pipeline_components/proto) which tracks the create Endpoint's long-running operation.",
            "parameterType": "STRING"
          }
        }
      }
    },
    "comp-exit-handler-1": {
      "dag": {
        "tasks": {
          "convert-checkpoints-op": {
            "cachingOptions": {
              "enableCache": true
            },
            "componentRef": {
              "name": "comp-convert-checkpoints-op"
            },
            "dependentTasks": [
              "fine-tunning"
            ],
            "inputs": {
              "parameters": {
                "bucket_name": {
                  "componentInputParameter": "pipelinechannel--bucket_name"
                },
                "keras_gcs_model": {
                  "taskOutputParameter": {
                    "outputParameterKey": "Output",
                    "producerTask": "fine-tunning"
                  }
                },
                "model_paths": {
                  "runtimeValue": {
                    "constant": {
                      "accelerator_count": 1.0,
                      "accelerator_type": "NVIDIA_L4",
                      "bucket_name": "personalize-chatbots-v1",
                      "cpu": "12.0",
                      "deployed_model_blob": "andrehpereh1/20240402162633/gemma_2b_en/huggingface",
                      "deployed_model_uri": "gs://personalize-chatbots-v1/andrehpereh1/20240402162633/gemma_2b_en/huggingface",
                      "fine_tuned_keras_blob": "andrehpereh1/20240402162633/gemma_2b_en/keras",
                      "finetuned_model_dir": "./gemma_2b_en",
                      "finetuned_vocab_path": "./gemma_2b_en/vocabulary.spm",
                      "finetuned_weights_path": "./gemma_2b_en/model.weights.h5",
                      "huggingface_model_dir": "./gemma_2b_en_huggingface",
                      "machine_type": "g2-standard-8",
                      "memory": "40G",
                      "model_name_vllm": "gemma_2b_en-vllm",
                      "model_size": "2b"
                    }
                  }
                }
              }
            },
            "taskInfo": {
              "name": "convert-checkpoints-op"
            }
          },
          "data-preparation-op": {
            "cachingOptions": {
              "enableCache": true
            },
            "componentRef": {
              "name": "comp-data-preparation-op"
            },
            "inputs": {
              "parameters": {
                "bucket_name": {
                  "componentInputParameter": "pipelinechannel--bucket_name"
                },
                "data_augmentation_iter": {
                  "componentInputParameter": "pipelinechannel--data_augmentation_iter"
                },
                "directory": {
                  "componentInputParameter": "pipelinechannel--directory"
                },
                "pair_count": {
                  "componentInputParameter": "pipelinechannel--pair_count"
                }
              }
            },
            "taskInfo": {
              "name": "data-preparation-op"
            }
          },
          "endpoint-create": {
            "cachingOptions": {
              "enableCache": true
            },
            "componentRef": {
              "name": "comp-endpoint-create"
            },
            "inputs": {
              "parameters": {
                "display_name": {
                  "runtimeValue": {
                    "constant": "End point created for andrehpereh"
                  }
                },
                "project": {
                  "componentInputParameter": "pipelinechannel--project"
                }
              }
            },
            "taskInfo": {
              "name": "endpoint-create"
            }
          },
          "fine-tunning": {
            "cachingOptions": {
              "enableCache": true
            },
            "componentRef": {
              "name": "comp-fine-tunning"
            },
            "dependentTasks": [
              "data-preparation-op"
            ],
            "inputs": {
              "artifacts": {
                "dataset_path": {
                  "taskOutputArtifact": {
                    "outputArtifactKey": "dataset_path",
                    "producerTask": "data-preparation-op"
                  }
                }
              },
              "parameters": {
                "bucket_name": {
                  "componentInputParameter": "pipelinechannel--bucket_name"
                },
                "epochs": {
                  "componentInputParameter": "pipelinechannel--epochs"
                },
                "fine_tune_flag": {
                  "componentInputParameter": "pipelinechannel--fine_tune_flag"
                },
                "model_name": {
                  "componentInputParameter": "pipelinechannel--model_name"
                },
                "model_paths": {
                  "runtimeValue": {
                    "constant": {
                      "accelerator_count": 1.0,
                      "accelerator_type": "NVIDIA_L4",
                      "bucket_name": "personalize-chatbots-v1",
                      "cpu": "12.0",
                      "deployed_model_blob": "andrehpereh1/20240402162633/gemma_2b_en/huggingface",
                      "deployed_model_uri": "gs://personalize-chatbots-v1/andrehpereh1/20240402162633/gemma_2b_en/huggingface",
                      "fine_tuned_keras_blob": "andrehpereh1/20240402162633/gemma_2b_en/keras",
                      "finetuned_model_dir": "./gemma_2b_en",
                      "finetuned_vocab_path": "./gemma_2b_en/vocabulary.spm",
                      "finetuned_weights_path": "./gemma_2b_en/model.weights.h5",
                      "huggingface_model_dir": "./gemma_2b_en_huggingface",
                      "machine_type": "g2-standard-8",
                      "memory": "40G",
                      "model_name_vllm": "gemma_2b_en-vllm",
                      "model_size": "2b"
                    }
                  }
                }
              }
            },
            "taskInfo": {
              "name": "fine-tunning"
            }
          },
          "importer": {
            "cachingOptions": {
              "enableCache": true
            },
            "componentRef": {
              "name": "comp-importer"
            },
            "dependentTasks": [
              "convert-checkpoints-op"
            ],
            "inputs": {
              "parameters": {
                "metadata": {
                  "componentInputParameter": "pipelinechannel--serving_image"
                },
                "uri": {
                  "taskOutputParameter": {
                    "outputParameterKey": "Output",
                    "producerTask": "convert-checkpoints-op"
                  }
                }
              }
            },
            "taskInfo": {
              "name": "importer"
            }
          },
          "model-deploy": {
            "cachingOptions": {
              "enableCache": true
            },
            "componentRef": {
              "name": "comp-model-deploy"
            },
            "dependentTasks": [
              "endpoint-create",
              "model-upload"
            ],
            "inputs": {
              "artifacts": {
                "endpoint": {
                  "taskOutputArtifact": {
                    "outputArtifactKey": "endpoint",
                    "producerTask": "endpoint-create"
                  }
                },
                "model": {
                  "taskOutputArtifact": {
                    "outputArtifactKey": "model",
                    "producerTask": "model-upload"
                  }
                }
              },
              "parameters": {
                "dedicated_resources_accelerator_count": {
                  "runtimeValue": {
                    "constant": 1.0
                  }
                },
                "dedicated_resources_accelerator_type": {
                  "runtimeValue": {
                    "constant": "NVIDIA_L4"
                  }
                },
                "dedicated_resources_machine_type": {
                  "runtimeValue": {
                    "constant": "g2-standard-8"
                  }
                },
                "dedicated_resources_max_replica_count": {
                  "runtimeValue": {
                    "constant": 1.0
                  }
                },
                "dedicated_resources_min_replica_count": {
                  "runtimeValue": {
                    "constant": 1.0
                  }
                },
                "deployed_model_display_name": {
                  "runtimeValue": {
                    "constant": "Model gemma_2b_en-vllm, for user:andrehpereh"
                  }
                }
              }
            },
            "taskInfo": {
              "name": "model-deploy"
            }
          },
          "model-upload": {
            "cachingOptions": {
              "enableCache": true
            },
            "componentRef": {
              "name": "comp-model-upload"
            },
            "dependentTasks": [
              "importer"
            ],
            "inputs": {
              "artifacts": {
                "unmanaged_container_model": {
                  "taskOutputArtifact": {
                    "outputArtifactKey": "artifact",
                    "producerTask": "importer"
                  }
                }
              },
              "parameters": {
                "display_name": {
                  "runtimeValue": {
                    "constant": "Mini andrehpereh model uploaded."
                  }
                },
                "project": {
                  "componentInputParameter": "pipelinechannel--project"
                }
              }
            },
            "taskInfo": {
              "name": "model-upload"
            }
          },
          "update-user-endpoint": {
            "cachingOptions": {
              "enableCache": true
            },
            "componentRef": {
              "name": "comp-update-user-endpoint"
            },
            "dependentTasks": [
              "model-deploy"
            ],
            "inputs": {
              "parameters": {
                "email": {
                  "runtimeValue": {
                    "constant": "andrehpereh@gmail.com"
                  }
                },
                "endpoint_resource": {
                  "taskOutputParameter": {
                    "outputParameterKey": "gcp_resources",
                    "producerTask": "model-deploy"
                  }
                },
                "project": {
                  "componentInputParameter": "pipelinechannel--project"
                }
              }
            },
            "taskInfo": {
              "name": "update-user-endpoint"
            }
          }
        }
      },
      "inputDefinitions": {
        "parameters": {
          "pipelinechannel--bucket_name": {
            "parameterType": "STRING"
          },
          "pipelinechannel--data_augmentation_iter": {
            "parameterType": "NUMBER_INTEGER"
          },
          "pipelinechannel--directory": {
            "parameterType": "STRING"
          },
          "pipelinechannel--epochs": {
            "parameterType": "NUMBER_INTEGER"
          },
          "pipelinechannel--fine_tune_flag": {
            "parameterType": "BOOLEAN"
          },
          "pipelinechannel--model_name": {
            "parameterType": "STRING"
          },
          "pipelinechannel--pair_count": {
            "parameterType": "NUMBER_INTEGER"
          },
          "pipelinechannel--project": {
            "parameterType": "STRING"
          },
          "pipelinechannel--serving_image": {
            "parameterType": "STRING"
          }
        }
      }
    },
    "comp-fine-tunning": {
      "executorLabel": "exec-fine-tunning",
      "inputDefinitions": {
        "artifacts": {
          "dataset_path": {
            "artifactType": {
              "schemaTitle": "system.Dataset",
              "schemaVersion": "0.0.1"
            }
          }
        },
        "parameters": {
          "bucket_name": {
            "parameterType": "STRING"
          },
          "epochs": {
            "parameterType": "NUMBER_INTEGER"
          },
          "fine_tune_flag": {
            "parameterType": "BOOLEAN"
          },
          "model_name": {
            "parameterType": "STRING"
          },
          "model_paths": {
            "parameterType": "STRUCT"
          }
        }
      },
      "outputDefinitions": {
        "parameters": {
          "Output": {
            "parameterType": "STRING"
          }
        }
      }
    },
    "comp-importer": {
      "executorLabel": "exec-importer",
      "inputDefinitions": {
        "parameters": {
          "metadata": {
            "parameterType": "STRING"
          },
          "uri": {
            "parameterType": "STRING"
          }
        }
      },
      "outputDefinitions": {
        "artifacts": {
          "artifact": {
            "artifactType": {
              "schemaTitle": "google.UnmanagedContainerModel",
              "schemaVersion": "0.0.1"
            }
          }
        }
      }
    },
    "comp-model-deploy": {
      "executorLabel": "exec-model-deploy",
      "inputDefinitions": {
        "artifacts": {
          "endpoint": {
            "artifactType": {
              "schemaTitle": "google.VertexEndpoint",
              "schemaVersion": "0.0.1"
            },
            "description": "The Endpoint to be deployed to.",
            "isOptional": true
          },
          "model": {
            "artifactType": {
              "schemaTitle": "google.VertexModel",
              "schemaVersion": "0.0.1"
            },
            "description": "The model to be deployed."
          }
        },
        "parameters": {
          "automatic_resources_max_replica_count": {
            "defaultValue": 0.0,
            "description": "The maximum number of replicas this DeployedModel may be deployed on when the traffic against it increases. If the requested value is too large, the deployment will error, but if deployment succeeds then the ability to scale the model to that many replicas is guaranteed (barring service outages). If traffic against the DeployedModel increases beyond what its replicas at maximum may handle, a portion of the traffic will be dropped. If this value is not provided, a no upper bound for scaling under heavy traffic will be assume, though Vertex AI may be unable to scale beyond certain replica number.",
            "isOptional": true,
            "parameterType": "NUMBER_INTEGER"
          },
          "automatic_resources_min_replica_count": {
            "defaultValue": 0.0,
            "description": "The minimum number of replicas this DeployedModel will be always deployed on. If traffic against it increases, it may dynamically be deployed onto more replicas up to `automatic_resources_max_replica_count`, and as traffic decreases, some of these extra replicas may be freed. If the requested value is too large, the deployment will error.  This field is required if `dedicated_resources_machine_type` is not specified.",
            "isOptional": true,
            "parameterType": "NUMBER_INTEGER"
          },
          "dedicated_resources_accelerator_count": {
            "defaultValue": 0.0,
            "description": "The number of accelerators to attach to a worker replica.",
            "isOptional": true,
            "parameterType": "NUMBER_INTEGER"
          },
          "dedicated_resources_accelerator_type": {
            "defaultValue": "",
            "description": "Hardware accelerator type. Must also set accelerator_count if used. See [available options](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/MachineSpec#AcceleratorType).  This field is required if `dedicated_resources_machine_type` is specified.",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "dedicated_resources_machine_type": {
            "defaultValue": "",
            "description": "The specification of a single machine used by the prediction.  This field is required if `automatic_resources_min_replica_count` is not specified.  See [more information](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints#dedicatedresources).",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "dedicated_resources_max_replica_count": {
            "defaultValue": 0.0,
            "description": "The maximum number of replicas this deployed model may the larger value of min_replica_count or 1 will be used. If value provided is smaller than min_replica_count, it will automatically be increased to be min_replica_count. The maximum number of replicas this deployed model may be deployed on when the traffic against it increases. If requested value is too large, the deployment will error, but if deployment succeeds then the ability to scale the model to that many replicas is guaranteed (barring service outages). If traffic against the deployed model increases beyond what its replicas at maximum may handle, a portion of the traffic will be dropped. If this value is not provided, will use `dedicated_resources_min_replica_count` as the default value.",
            "isOptional": true,
            "parameterType": "NUMBER_INTEGER"
          },
          "dedicated_resources_min_replica_count": {
            "defaultValue": 0.0,
            "description": "The minimum number of machine replicas this DeployedModel will be always deployed on. This value must be greater than or equal to 1. If traffic against the DeployedModel increases, it may dynamically be deployed onto more replicas, and as traffic decreases, some of these extra replicas may be freed.",
            "isOptional": true,
            "parameterType": "NUMBER_INTEGER"
          },
          "deployed_model_display_name": {
            "defaultValue": "",
            "description": "The display name of the DeployedModel. If not provided upon creation, the Model's display_name is used.",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "disable_container_logging": {
            "defaultValue": false,
            "description": "For custom-trained Models and AutoML Tabular Models, the container of the DeployedModel instances will send stderr and stdout streams to Stackdriver Logging by default. Please note that the logs incur cost, which are subject to Cloud Logging pricing.  User can disable container logging by setting this flag to true.",
            "isOptional": true,
            "parameterType": "BOOLEAN"
          },
          "enable_access_logging": {
            "defaultValue": false,
            "description": "These logs are like standard server access logs, containing information like timestamp and latency for each prediction request.  Note that Stackdriver logs may incur a cost, especially if your project receives prediction requests at a high queries per second rate (QPS). Estimate your costs before enabling this option.",
            "isOptional": true,
            "parameterType": "BOOLEAN"
          },
          "explanation_metadata": {
            "defaultValue": {},
            "description": "Metadata describing the Model's input and output for explanation. See [more information](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/ExplanationSpec#explanationmetadata).",
            "isOptional": true,
            "parameterType": "STRUCT"
          },
          "explanation_parameters": {
            "defaultValue": {},
            "description": "Parameters that configure explaining information of the Model's predictions. See [more information](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/ExplanationSpec#explanationmetadata).",
            "isOptional": true,
            "parameterType": "STRUCT"
          },
          "service_account": {
            "defaultValue": "",
            "description": "The service account that the DeployedModel's container runs as. Specify the email address of the service account. If this service account is not specified, the container runs as a service account that doesn't have access to the resource project.  Users deploying the Model must have the `iam.serviceAccounts.actAs` permission on this service account.",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "traffic_split": {
            "defaultValue": {},
            "description": "A map from a DeployedModel's ID to the percentage of this Endpoint's traffic that should be forwarded to that DeployedModel.  If this field is non-empty, then the Endpoint's trafficSplit will be overwritten with it. To refer to the ID of the just being deployed Model, a \"0\" should be used, and the actual ID of the new DeployedModel will be filled in its place by this method. The traffic percentage values must add up to 100.  If this field is empty, then the Endpoint's trafficSplit is not updated.",
            "isOptional": true,
            "parameterType": "STRUCT"
          }
        }
      },
      "outputDefinitions": {
        "parameters": {
          "gcp_resources": {
            "description": "Serialized JSON of `gcp_resources` [proto](https://github.com/kubeflow/pipelines/tree/master/components/google-cloud/google_cloud_pipeline_components/proto) which tracks the deploy Model's long-running operation.",
            "parameterType": "STRING"
          }
        }
      }
    },
    "comp-model-upload": {
      "executorLabel": "exec-model-upload",
      "inputDefinitions": {
        "artifacts": {
          "parent_model": {
            "artifactType": {
              "schemaTitle": "google.VertexModel",
              "schemaVersion": "0.0.1"
            },
            "description": "An artifact of a model which to upload a new version to. Only specify this field when uploading a new version. [More information.](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.models/upload#request-body)",
            "isOptional": true
          },
          "unmanaged_container_model": {
            "artifactType": {
              "schemaTitle": "google.UnmanagedContainerModel",
              "schemaVersion": "0.0.1"
            },
            "description": "The unmanaged container model to be uploaded.  The Model can be passed from an upstream step or imported via a KFP `dsl.importer`. Example:\nfrom kfp import dsl\nfrom google_cloud_pipeline_components.types import artifact_types\n\nimporter_spec = dsl.importer( artifact_uri='gs://managed-pipeline-gcpc-e2e-test/automl-tabular/model', artifact_class=artifact_types.UnmanagedContainerModel, metadata={ 'containerSpec': { 'imageUri': 'us-docker.pkg.dev/vertex-ai/automl-tabular/prediction-server:prod' } })",
            "isOptional": true
          }
        },
        "parameters": {
          "description": {
            "defaultValue": "",
            "description": "The description of the Model. [More information.](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.models#Model)",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "display_name": {
            "description": "The display name of the Model. The name can be up to 128 characters long and can be consist of any UTF-8 characters. [More information.](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.models#Model)",
            "parameterType": "STRING"
          },
          "encryption_spec_key_name": {
            "defaultValue": "",
            "description": "Customer-managed encryption key spec for a Model. If set, this Model and all sub-resources of this Model will be secured by this key.  Has the form: `projects/my-project/locations/my-location/keyRings/my-kr/cryptoKeys/my-key`. The key needs to be in the same region as where the compute resource is created.",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "explanation_metadata": {
            "defaultValue": {},
            "description": "Metadata describing the Model's input and output for explanation. Both `explanation_metadata` and `explanation_parameters` must be passed together when used. [More information.](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/ExplanationSpec#explanationmetadata)",
            "isOptional": true,
            "parameterType": "STRUCT"
          },
          "explanation_parameters": {
            "defaultValue": {},
            "description": "Parameters to configure explaining for Model's predictions.  [More information.](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/ExplanationSpec#ExplanationParameters)",
            "isOptional": true,
            "parameterType": "STRUCT"
          },
          "labels": {
            "defaultValue": {},
            "description": "The labels with user-defined metadata to organize your model.  Label keys and values can be no longer than 64 characters (Unicode codepoints), can only contain lowercase letters, numeric characters, underscores and dashes. International characters are allowed.  See https://goo.gl/xmQnxf for more information and examples of labels.",
            "isOptional": true,
            "parameterType": "STRUCT"
          },
          "location": {
            "defaultValue": "us-central1",
            "description": "Optional location to upload this Model to. If not set, defaults to `us-central1`.",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "project": {
            "defaultValue": "{{$.pipeline_google_cloud_project_id}}",
            "description": "Project to upload this Model to. Defaults to the project in which the PipelineJob is run.",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "version_aliases": {
            "defaultValue": [],
            "description": "User provided version aliases so that a model version can be referenced via alias (i.e. `projects/{project}/locations/{location}/models/{modelId}@{version_alias}` instead of auto-generated version id (i.e. `projects/{project}/locations/{location}/models/{modelId}@{versionId}`). The format is [a-z][a-zA-Z0-9-]{0,126}[a-z0-9] to distinguish from versionId. A default version alias will be created for the first version of the model, and there must be exactly one default version alias for a model.",
            "isOptional": true,
            "parameterType": "LIST"
          }
        }
      },
      "outputDefinitions": {
        "artifacts": {
          "model": {
            "artifactType": {
              "schemaTitle": "google.VertexModel",
              "schemaVersion": "0.0.1"
            },
            "description": "Artifact tracking the created Model version."
          }
        },
        "parameters": {
          "gcp_resources": {
            "description": "Serialized JSON of `gcp_resources` [proto](https://github.com/kubeflow/pipelines/tree/master/components/google-cloud/google_cloud_pipeline_components/proto) which tracks the upload Model's long-running operation.",
            "parameterType": "STRING"
          }
        }
      }
    },
    "comp-send-pipeline-completion-email-op": {
      "executorLabel": "exec-send-pipeline-completion-email-op",
      "inputDefinitions": {
        "parameters": {
          "email_password": {
            "defaultValue": "ssuy rubm kzge juid",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "project": {
            "parameterType": "STRING"
          },
          "recipient_emails": {
            "defaultValue": "andrehpereh@gmail.com",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "sender_email": {
            "defaultValue": "andrehpereh96@gmail.com",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "smtp_port": {
            "defaultValue": 587.0,
            "isOptional": true,
            "parameterType": "NUMBER_INTEGER"
          },
          "smtp_server": {
            "defaultValue": "smtp.gmail.com",
            "isOptional": true,
            "parameterType": "STRING"
          },
          "status": {
            "isOptional": true,
            "parameterType": "TASK_FINAL_STATUS"
          }
        }
      }
    },
    "comp-update-user-endpoint": {
      "executorLabel": "exec-update-user-endpoint",
      "inputDefinitions": {
        "parameters": {
          "email": {
            "parameterType": "STRING"
          },
          "endpoint_resource": {
            "parameterType": "STRING"
          },
          "project": {
            "parameterType": "STRING"
          }
        }
      }
    }
  },
  "deploymentSpec": {
    "executors": {
      "exec-convert-checkpoints-op": {
        "container": {
          "args": [
            "--executor_input",
            "{{$}}",
            "--function_to_execute",
            "convert_checkpoints_op"
          ],
          "command": [
            "sh",
            "-c",
            "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.7.0' '--no-deps' 'typing-extensions>=3.7.4,<5; python_version<\"3.9\"' && \"$0\" \"$@\"\n",
            "sh",
            "-ec",
            "program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" > \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n",
            "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef convert_checkpoints_op(\n  keras_gcs_model: str,\n  model_paths: dict,\n  bucket_name: str\n) -> str:\n    import conversion_function\n    import os\n    import util\n    print(\"This is the keras passed\", keras_gcs_model)\n    util.download_all_from_blob(bucket_name, model_paths['fine_tuned_keras_blob'], local_destination=model_paths['finetuned_model_dir'])\n    if os.path.exists(\"./model.weights.h5\"):\n        print(\"File exists!\")\n    else:\n        print(\"File does not exist.\")\n    converted_fined_tuned_path = conversion_function.convert_checkpoints(\n        weights_file=model_paths['finetuned_weights_path'],\n        size=model_paths['model_size'],\n        output_dir=model_paths['huggingface_model_dir'],\n        vocab_path=model_paths['finetuned_vocab_path']\n    )\n    util.upload2bs(\n        local_directory = converted_fined_tuned_path, bucket_name = bucket_name,\n        destination_subfolder = model_paths['deployed_model_blob']\n    )\n    return model_paths['deployed_model_uri']\n\n"
          ],
          "image": "gcr.io/able-analyst-416817/gemma-chatbot-fine-tunning:masterv6",
          "resources": {
            "accelerator": {
              "count": "1",
              "type": "NVIDIA_L4"
            },
            "cpuLimit": 12.0,
            "memoryLimit": 50.0
          }
        }
      },
      "exec-data-preparation-op": {
        "container": {
          "args": [
            "--executor_input",
            "{{$}}",
            "--function_to_execute",
            "data_preparation_op"
          ],
          "command": [
            "sh",
            "-c",
            "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.7.0' '--no-deps' 'typing-extensions>=3.7.4,<5; python_version<\"3.9\"' && \"$0\" \"$@\"\n",
            "sh",
            "-ec",
            "program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" > \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n",
            "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef data_preparation_op(\n    bucket_name: str,\n    directory: str,\n    dataset_path: OutputPath('Dataset'),\n    pair_count: int=4,\n    data_augmentation_iter: int=4\n):\n    import data_ingestion\n    import json\n    from vertexai.preview.generative_models import GenerativeModel\n    gemini_pro_model = GenerativeModel(\"gemini-1.0-pro\")\n    formatted_messages = data_ingestion.data_preparation(\n        bucket_name=bucket_name, directory=directory, gemini_pro_model=gemini_pro_model,\n        pair_count=pair_count, data_augmentation_iter=data_augmentation_iter\n    )\n    with open(dataset_path, 'w') as f:\n        json.dump(formatted_messages, f)\n\n"
          ],
          "image": "gcr.io/able-analyst-416817/gemma-chatbot-data-preparation:masterv6"
        }
      },
      "exec-endpoint-create": {
        "container": {
          "args": [
            "--type",
            "CreateEndpoint",
            "--payload",
            "{\"Concat\": [\"{\", \"\\\"display_name\\\": \\\"\", \"{{$.inputs.parameters['display_name']}}\", \"\\\"\", \", \\\"description\\\": \\\"\", \"{{$.inputs.parameters['description']}}\", \"\\\"\", \", \\\"labels\\\": \", \"{{$.inputs.parameters['labels']}}\", \", \\\"encryption_spec\\\": {\\\"kms_key_name\\\":\\\"\", \"{{$.inputs.parameters['encryption_spec_key_name']}}\", \"\\\"}\", \", \\\"network\\\": \\\"\", \"{{$.inputs.parameters['network']}}\", \"\\\"\", \"}\"]}",
            "--project",
            "{{$.inputs.parameters['project']}}",
            "--location",
            "{{$.inputs.parameters['location']}}",
            "--gcp_resources",
            "{{$.outputs.parameters['gcp_resources'].output_file}}",
            "--executor_input",
            "{{$}}"
          ],
          "command": [
            "python3",
            "-u",
            "-m",
            "google_cloud_pipeline_components.container.v1.endpoint.create_endpoint.launcher"
          ],
          "image": "gcr.io/ml-pipeline/google-cloud-pipeline-components:2.12.0"
        }
      },
      "exec-fine-tunning": {
        "container": {
          "args": [
            "--executor_input",
            "{{$}}",
            "--function_to_execute",
            "fine_tunning"
          ],
          "command": [
            "sh",
            "-c",
            "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.7.0' '--no-deps' 'typing-extensions>=3.7.4,<5; python_version<\"3.9\"' && \"$0\" \"$@\"\n",
            "sh",
            "-ec",
            "program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" > \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n",
            "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef fine_tunning(\n  dataset_path: InputPath('Dataset'),\n  model_paths: dict,\n  fine_tune_flag: bool,\n  epochs: int,\n  model_name: str,\n  bucket_name: str\n) -> str:\n    import trainer\n    import json\n    import util\n    import os\n    with open(dataset_path, 'r') as f:\n        dataset = json.load(f)\n    os.makedirs(model_paths['finetuned_model_dir'], exist_ok=True)\n    finetuned_weights_path = os.path.join(model_paths['finetuned_model_dir'], 'model.weights.h5') \n\n    model = trainer.finetune_gemma(dataset, model_paths, fine_tune_flag, epochs=epochs, model_name=model_name)\n    print(\"Its gonna save it here\", finetuned_weights_path)\n    util.upload2bs(\n        local_directory = model_paths['finetuned_model_dir'], bucket_name = bucket_name,\n        destination_subfolder = model_paths['fine_tuned_keras_blob']\n    )\n    model_gcs = \"gs://{}/{}\".format(bucket_name, model_paths['fine_tuned_keras_blob'])  \n    print(\"This is the storage bucket\", model_gcs)\n    return model_gcs\n\n"
          ],
          "image": "gcr.io/able-analyst-416817/gemma-chatbot-fine-tunning:masterv6",
          "resources": {
            "accelerator": {
              "count": "1",
              "type": "NVIDIA_L4"
            },
            "cpuLimit": 12.0,
            "memoryLimit": 50.0
          }
        }
      },
      "exec-importer": {
        "importer": {
          "artifactUri": {
            "runtimeParameter": "uri"
          },
          "metadata": {
            "containerSpec": {
              "args": [
                "--host=0.0.0.0",
                "--port=7080",
                "--tensor-parallel-size=1",
                "--swap-space=16",
                "--gpu-memory-utilization=0.95",
                "--max-model-len=256",
                "--dtype=bfloat16",
                "--disable-log-stats"
              ],
              "command": [
                "python",
                "-m",
                "vllm.entrypoints.api_server"
              ],
              "healthRoute": "/ping",
              "imageUri": "{{$.inputs.parameters['metadata']}}",
              "ports": [
                {
                  "containerPort": 7080.0
                }
              ],
              "predictRoute": "/generate"
            }
          },
          "typeSchema": {
            "schemaTitle": "google.UnmanagedContainerModel",
            "schemaVersion": "0.0.1"
          }
        }
      },
      "exec-model-deploy": {
        "container": {
          "args": [
            "--type",
            "DeployModel",
            "--payload",
            "{\"Concat\": [\"{\", \"\\\"endpoint\\\": \\\"\", \"{{$.inputs.artifacts['endpoint'].metadata['resourceName']}}\", \"\\\"\", \", \\\"traffic_split\\\": \", \"{{$.inputs.parameters['traffic_split']}}\", \", \\\"deployed_model\\\": {\", \"\\\"model\\\": \\\"\", \"{{$.inputs.artifacts['model'].metadata['resourceName']}}\", \"\\\"\", \", \\\"dedicated_resources\\\": {\", \"\\\"machine_spec\\\": {\", \"\\\"machine_type\\\": \\\"\", \"{{$.inputs.parameters['dedicated_resources_machine_type']}}\", \"\\\"\", \", \\\"accelerator_type\\\": \\\"\", \"{{$.inputs.parameters['dedicated_resources_accelerator_type']}}\", \"\\\"\", \", \\\"accelerator_count\\\": \", \"{{$.inputs.parameters['dedicated_resources_accelerator_count']}}\", \"}\", \", \\\"min_replica_count\\\": \", \"{{$.inputs.parameters['dedicated_resources_min_replica_count']}}\", \", \\\"max_replica_count\\\": \", \"{{$.inputs.parameters['dedicated_resources_max_replica_count']}}\", \"}\", \", \\\"automatic_resources\\\": {\", \"\\\"min_replica_count\\\": \", \"{{$.inputs.parameters['automatic_resources_min_replica_count']}}\", \", \\\"max_replica_count\\\": \", \"{{$.inputs.parameters['automatic_resources_max_replica_count']}}\", \"}\", \", \\\"service_account\\\": \\\"\", \"{{$.inputs.parameters['service_account']}}\", \"\\\"\", \", \\\"disable_container_logging\\\": \", \"{{$.inputs.parameters['disable_container_logging']}}\", \", \\\"enable_access_logging\\\": \", \"{{$.inputs.parameters['enable_access_logging']}}\", \", \\\"explanation_spec\\\": {\", \"\\\"parameters\\\": \", \"{{$.inputs.parameters['explanation_parameters']}}\", \", \\\"metadata\\\": \", \"{{$.inputs.parameters['explanation_metadata']}}\", \"}\", \"}\", \"}\"]}",
            "--project",
            "",
            "--location",
            "",
            "--gcp_resources",
            "{{$.outputs.parameters['gcp_resources'].output_file}}"
          ],
          "command": [
            "python3",
            "-u",
            "-m",
            "google_cloud_pipeline_components.container.v1.endpoint.deploy_model.launcher"
          ],
          "image": "gcr.io/ml-pipeline/google-cloud-pipeline-components:2.12.0"
        }
      },
      "exec-model-upload": {
        "container": {
          "args": [
            "--type",
            "UploadModel",
            "--payload",
            "{\"Concat\": [\"{\", \"\\\"display_name\\\": \\\"\", \"{{$.inputs.parameters['display_name']}}\", \"\\\"\", \", \\\"description\\\": \\\"\", \"{{$.inputs.parameters['description']}}\", \"\\\"\", \", \\\"explanation_spec\\\": {\", \"\\\"parameters\\\": \", \"{{$.inputs.parameters['explanation_parameters']}}\", \", \\\"metadata\\\": \", \"{{$.inputs.parameters['explanation_metadata']}}\", \"}\", \", \\\"encryption_spec\\\": {\\\"kms_key_name\\\":\\\"\", \"{{$.inputs.parameters['encryption_spec_key_name']}}\", \"\\\"}\", \", \\\"version_aliases\\\": \", \"{{$.inputs.parameters['version_aliases']}}\", \", \\\"labels\\\": \", \"{{$.inputs.parameters['labels']}}\", \", \\\"pipeline_job\\\": \\\"\", \"projects/{{$.inputs.parameters['project']}}/locations/{{$.inputs.parameters['location']}}/pipelineJobs/{{$.pipeline_job_uuid}}\", \"\\\"\", \"}\"]}",
            "--project",
            "{{$.inputs.parameters['project']}}",
            "--location",
            "{{$.inputs.parameters['location']}}",
            "--gcp_resources",
            "{{$.outputs.parameters['gcp_resources'].output_file}}",
            "--executor_input",
            "{{$}}",
            "{\"IfPresent\": {\"InputName\": \"parent_model\", \"Then\": [\"--parent_model_name\", \"{{$.inputs.artifacts['parent_model'].metadata['resourceName']}}\"]}}"
          ],
          "command": [
            "python3",
            "-u",
            "-m",
            "google_cloud_pipeline_components.container.v1.model.upload_model.launcher"
          ],
          "image": "gcr.io/ml-pipeline/google-cloud-pipeline-components:2.12.0"
        }
      },
      "exec-send-pipeline-completion-email-op": {
        "container": {
          "args": [
            "--executor_input",
            "{{$}}",
            "--function_to_execute",
            "send_pipeline_completion_email_op"
          ],
          "command": [
            "sh",
            "-c",
            "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.7.0' '--no-deps' 'typing-extensions>=3.7.4,<5; python_version<\"3.9\"'  &&  python3 -m pip install --quiet --no-warn-script-location 'google-cloud-bigquery' && \"$0\" \"$@\"\n",
            "sh",
            "-ec",
            "program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" > \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n",
            "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef send_pipeline_completion_email_op(\n    project: str,\n    status: PipelineTaskFinalStatus,\n    smtp_server: str = 'smtp.gmail.com',\n    smtp_port: int = 587,\n    sender_email: str = 'andrehpereh96@gmail.com',\n    recipient_emails: str = \"andrehpereh@gmail.com\",\n    email_password: str = \"ssuy rubm kzge juid\"\n):\n    import smtplib\n    from email.mime.text import MIMEText\n    from google.cloud import bigquery\n    recipient_emails = [recipient_emails]\n\n    DATASET_ID = 'chatbot' # This should be moved to a config file\n    USER_TRAINING_STATUS = 'user_training_status' # This should be moved to a config file\n    \"\"\"\n    Monitors for a success flag file and sends an email upon detection.\n\n    Args:\n        smtp_server (str): SMTP server address. Defaults to 'smtp.gmail.com'.\n        smtp_port (int): SMTP server port. Defaults to 587.\n        sender_email (str): Email address of the sender. Defaults to 'your_email@gmail.com'.\n        recipient_emails (list): List of recipient email addresses. Defaults to ['recipient@example.com'].\n        email_password (str): Password for the sender's email account.\n        success_flag_path (str): Path to the success flag file. Defaults to '/tmp/pipeline_success_flag.txt'.\n    \"\"\"\n\n    msg = MIMEText(\n        f\"Kubeflow Pipeline Completion Status; {status.state} and Job resource name:{status.pipeline_job_resource_name},\\\n        \\nPipeline task name: {status.pipeline_task_name} Errormessage: , {status.error_message}\"\n    )\n    msg['Subject'] = 'Kubeflow Pipeline Completion'\n    msg['From'] = sender_email\n    msg['To'] = ', '.join(recipient_emails)\n\n    with smtplib.SMTP(smtp_server, smtp_port) as server:\n        server.starttls()  # Enable TLS encryption\n        print(\"This is the email\", sender_email)\n        print(\"This is the password\", email_password)\n        server.login(sender_email, email_password)\n        server.sendmail(sender_email, recipient_emails, msg.as_string())\n    if status.state == \"SUCCEEDED\":\n        client = bigquery.Client(project)\n        print(\"This is the client\", client)\n        table_ref = client.dataset(DATASET_ID).table(USER_TRAINING_STATUS)\n        table = client.get_table(table_ref)\n        row_to_insert = {\n            'email': recipient_emails,\n            'training_status': 1\n        }\n        client.insert_rows(table, [row_to_insert]) \n        errors = client.insert_rows(table, [row_to_insert])\n        if errors:  # Check if there were errors\n            print(\"The model has been trained, but error updating training_status for {}: {}\".format(email_password, errors))\n        else:\n            print(\"User training has been updated\")\n\n    print('Email sent!')\n\n"
          ],
          "image": "python:3.9"
        }
      },
      "exec-update-user-endpoint": {
        "container": {
          "args": [
            "--executor_input",
            "{{$}}",
            "--function_to_execute",
            "update_user_endpoint"
          ],
          "command": [
            "sh",
            "-c",
            "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.7.0' '--no-deps' 'typing-extensions>=3.7.4,<5; python_version<\"3.9\"'  &&  python3 -m pip install --quiet --no-warn-script-location 'google-cloud-bigquery' && \"$0\" \"$@\"\n",
            "sh",
            "-ec",
            "program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" > \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n",
            "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef update_user_endpoint(\n    endpoint_resource: str,\n    email: str,\n    project: str\n):\n\n    import os\n    from google.cloud import bigquery\n    DATASET_ID = 'chatbot' # This should be moved to a config file\n    USER_TRAINING_STATUS = 'user_training_status' # This should be moved to a config file\n    #This part can be wrapped in a function\n    import json\n    data = json.loads(endpoint_resource)\n    resource_uri = data['resources'][0]['resourceUri']\n\n    print(\"This is the passed end pooint\", endpoint_resource)\n    print(dir(endpoint_resource))\n    print(type(endpoint_resource))\n    print(\"This is the project\", project)\n\n    client = bigquery.Client(project)\n    print(\"This is the client\", client)\n    table_ref = client.dataset(DATASET_ID).table(USER_TRAINING_STATUS)\n    table = client.get_table(table_ref)\n    row_to_insert = {\n        'email': email,\n        'end_point': resource_uri,\n        'training_status': True\n    }\n    client.insert_rows(table, [row_to_insert]) \n    errors = client.insert_rows(table, [row_to_insert])\n    if errors:  # Check if there were errors\n        print(\"The model has been trained, but error updating resource_uri for {}: {}\".format(email, errors))\n    else:\n        print(\"User training has been updated\")\n    print(\"End point has been stored.\")\n\n"
          ],
          "image": "python:3.9"
        }
      }
    }
  },
  "pipelineInfo": {
    "name": "model-deployment"
  },
  "root": {
    "dag": {
      "tasks": {
        "exit-handler-1": {
          "componentRef": {
            "name": "comp-exit-handler-1"
          },
          "inputs": {
            "parameters": {
              "pipelinechannel--bucket_name": {
                "componentInputParameter": "bucket_name"
              },
              "pipelinechannel--data_augmentation_iter": {
                "componentInputParameter": "data_augmentation_iter"
              },
              "pipelinechannel--directory": {
                "componentInputParameter": "directory"
              },
              "pipelinechannel--epochs": {
                "componentInputParameter": "epochs"
              },
              "pipelinechannel--fine_tune_flag": {
                "componentInputParameter": "fine_tune_flag"
              },
              "pipelinechannel--model_name": {
                "componentInputParameter": "model_name"
              },
              "pipelinechannel--pair_count": {
                "componentInputParameter": "pair_count"
              },
              "pipelinechannel--project": {
                "componentInputParameter": "project"
              },
              "pipelinechannel--serving_image": {
                "componentInputParameter": "serving_image"
              }
            }
          },
          "taskInfo": {
            "name": "exit-handler-1"
          }
        },
        "send-pipeline-completion-email-op": {
          "cachingOptions": {
            "enableCache": true
          },
          "componentRef": {
            "name": "comp-send-pipeline-completion-email-op"
          },
          "dependentTasks": [
            "exit-handler-1"
          ],
          "inputs": {
            "parameters": {
              "project": {
                "componentInputParameter": "project"
              },
              "recipient_emails": {
                "runtimeValue": {
                  "constant": "andrehpereh@gmail.com"
                }
              },
              "status": {
                "taskFinalStatus": {
                  "producerTask": "exit-handler-1"
                }
              }
            }
          },
          "taskInfo": {
            "name": "send-pipeline-completion-email-op"
          },
          "triggerPolicy": {
            "strategy": "ALL_UPSTREAM_TASKS_COMPLETED"
          }
        }
      }
    },
    "inputDefinitions": {
      "parameters": {
        "bucket_name": {
          "defaultValue": "able-analyst-416817-chatbot-v1",
          "isOptional": true,
          "parameterType": "STRING"
        },
        "data_augmentation_iter": {
          "defaultValue": 4.0,
          "isOptional": true,
          "parameterType": "NUMBER_INTEGER"
        },
        "directory": {
          "defaultValue": "input_data/andrehpereh",
          "isOptional": true,
          "parameterType": "STRING"
        },
        "epochs": {
          "defaultValue": 3.0,
          "isOptional": true,
          "parameterType": "NUMBER_INTEGER"
        },
        "fine_tune_flag": {
          "defaultValue": false,
          "isOptional": true,
          "parameterType": "BOOLEAN"
        },
        "model_name": {
          "defaultValue": "gemma_2b_en",
          "isOptional": true,
          "parameterType": "STRING"
        },
        "pair_count": {
          "defaultValue": 6.0,
          "isOptional": true,
          "parameterType": "NUMBER_INTEGER"
        },
        "project": {
          "isOptional": true,
          "parameterType": "STRING"
        },
        "serving_image": {
          "defaultValue": "us-docker.pkg.dev/vertex-ai/vertex-vision-model-garden-dockers/pytorch-vllm-serve:20240220_0936_RC01",
          "isOptional": true,
          "parameterType": "STRING"
        }
      }
    }
  },
  "schemaVersion": "2.1.0",
  "sdkVersion": "kfp-2.7.0"
}